<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="mapper.course">
	<resultMap id="courseResult" type="courseVO">
		<result property="courseID" column="courseID" />
		<result property="syllabusID" column="syllabusID" />
		<result property="courseStart" column="courseStart" />
        <result property="courseEnd" column="courseEnd" />        
        <result property="courseApplyStart" column="courseApplyStart" />
        <result property="courseApplyEnd" column="courseApplyEnd" />
        <result property="courseTime" column="courseTime" />
        <result property="courseFee" column="courseFee" />
        <result property="courseRoomNumber" column="courseRoomNumber" />
        <result property="coursePeopleMax" column="coursePeopleMax" />
        <result property="coursePeopleApplied" column="coursePeopleApplied" />
        <result property="courseState" column="courseState" />
        <result property="courseShow" column="courseShow" />
        
        <collection property="syllabusVO" javaType="SyllabusVO">
        	<result property="syllabusCategory1" column="syllabusCategory1" />
        	<result property="syllabusCategory2" column="syllabusCategory2" />
        	<result property="syllabusName" column="syllabusName" />
        	<result property="syllabusOutline" column="syllabusOutline" />
        	<result property="syllabusPurpose" column="syllabusPurpose" />
        	<result property="syllabusTarget" column="syllabusTarget" />
        	<result property="syllabusContent" column="syllabusContent" />
        </collection>
	</resultMap>
	
	<select id="selectCourseList" resultMap="courseResult">
	 <![CDATA[
	    select courseID, s.syllabusID, s.syllabusCategory1, s.syllabusCategory2, s.syllabusName, coursePeopleMax, 
	    courseFee, courseApplyStart, courseApplyEnd, courseStart, courseEnd
	    from course c join syllabus s on c.syllabusID = s.syllabusID
	    order by courseID desc
	 ]]>
	</select>
	<select id="selectCourse" parameterType="int" resultMap="courseResult">
	 <![CDATA[
	 	select courseID, c.syllabusID, s.syllabusCategory1, s.syllabusCategory2, s.syllabusName, courseRoomNumber,
	 			courseStart, courseEnd, courseApplyStart, courseApplyEnd, courseTime, courseFee, coursePeopleMax,
	 			syllabusOutline, syllabusPurpose, syllabusTarget, syllabusContent
	 	from course c join syllabus s on c.syllabusID = s.syllabusID
	 	where courseID = #{courseID}
	 ]]>
	</select>
	<!-- 왜 YYYY로 하면 안 되지......? -->
	<insert id="insertCourse" parameterType="courseVO">
	  <![CDATA[
	  	insert into course (courseid, syllabusid, coursestart, courseend, courseapplystart, courseapplyend, coursetime, coursefee, courseroomnumber, coursepeoplemax)
		values(course_seq.NEXTVAL, #{syllabusID}, TO_DATE(#{courseStart}, 'YY-MM-DD'), TO_DATE(#{courseEnd}, 'YY-MM-DD'), TO_DATE(#{courseApplyStart}, 'YY-MM-DD'), TO_DATE(#{courseApplyEnd}, 'YY-MM-DD'),#{courseTime},#{courseFee},#{courseRoomNumber},#{coursePeopleMax})
	  ]]>
	</insert>
	<delete id="deleteCourse" parameterType="int">
     <![CDATA[
       delete from course where courseID = #{courseID}
     ]]>
    </delete>
    <!-- syllabus, course 둘 다 업데이트 할 수 있을까,,, -->
	<update id="modifyCourse" parameterType="courseVO">
	 <![CDATA[
	 	update course set syllabusID=#{syllabusID}, coursestart=#{coursestart}, courseend=#{courseend}, courseapplystart=#{courseapplystart}, 
	 	courseapplyend=#{courseapplyend}, coursetime=#{coursetime}, coursefee=#{coursefee}, courseroomnumber=#{courseroomnumber}, coursepeoplemax=#{coursepeoplemax}
	 	where courseid = #{courseID}
	 ]]> 
	</update>
</mapper>