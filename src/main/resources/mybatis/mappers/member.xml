<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.member">
	<resultMap id="memResult" type="memberVO">
		<result property="userId" column="userId" />
		<result property="userPassword" column="userPassword" />
		<result property="userName" column="userName" />
		<result property="userEmail" column="userEmail" />
		<result property="birth" column="birth" />
		<result property="userGender" column="userGender" />
		<result property="userMajor" column="userMajor" />
		<result property="userPosition" column="userPosition" />
		<result property="userJob" column="userJob" />
		<result property="userCompany" column="userCompany" />
		<result property="userPhoneNumber" column="userPhoneNumber" />
		<result property="userAddress1" column="userAddress1" />
		<result property="userAddress2" column="userAddress2" />
		<result property="userJoindate" column="userJoindate" />
		<result property="approval_status" column="approval_status" />
		<result property="resume" column="resume" />
	</resultMap>

	<resultMap id="resResult" type="partnerVO">
		<result property="partnerLicenseNum" column="partnerLicenseNum" />
	    <result property="partnerState" column="partnerState" />
	    <result property="partnerName" column="partnerName" />
	    <result property="partnerInformation" column="partnerInformation" />
	    <result property="partnerAddress" column="partnerAddress" />
	    <result property="partnerPhoneNumber" column="partnerPhoneNumber" />
	    <result property="partnerEmail" column="partnerEmail" />
	    <result property="partnerCEO" column="partnerCEO" />
	    <result property="partnerHeadCount" column="partnerHeadCount" />
	    <result property="partnerApplyYN" column="partnerApplyYN" />
	    <result property="partnerApplyFinishDate" column="partnerApplyFinishDate" />
	    <result property="partnerURL" column="partnerURL" />
	    <result property="partnerRegisterDate" column="partnerRegisterDate" />
	</resultMap>



	<select id="selectAllMemberList" resultMap="memResult">
      <![CDATA[
         select * from kt_user order by userJoindate desc	 	
      ]]>
	</select>

	<!-- <insert id="insertMember" parameterType="memberVO"> <![CDATA[ insert 
		into t_member1(id,pwd, name, email,birth,phone,address,address_detail) values(#{id}, 
		#{pwd}, #{name}, #{email},#{birth},#{phone},#{address},#{address_detail}) 
		]]> </insert> -->

	<!-- 아이디 중복 검사 -->
	<select id="check_id" parameterType="String" resultType="int">
		select
		count(*) from kt_user where userId = #{userId}
	</select>

	<!-- 이메일 중복 검사 -->
	<select id="check_email" parameterType="String" resultType="int">
		select count(*) from kt_user where userEmail = #{userEmail}
	</select>

	<!-- 내정보 가져오기 -->
	<select id="get_myInformation" parameterType="String"
		resultType="memberVO">
		select * from kt_user where userId = #{userID}
	</select>

	<!-- 회원 가입 -->
	<insert id="join_member" parameterType="memberVO">
		insert into kt_user
		values(#{userId},#{userPassword},#{userName},#{userMajor},#{userGender},#{userPosition},#{userCompany},
		#{userEmail},#{userPhoneNumber},#{userAddress1},#{userAddress2},'N',#{birth},#{userJob},to_char(sysdate),'false')
	</insert>

	<!-- 이메일 인증 -->
	<update id="approval_member" parameterType="memberVO">
		update kt_user set
		approval_status = 'true'
		where userEmail = #{userEmail} <!-- and approval_key = #{approval_key} -->
	</update>


	<update id="updateMember" parameterType="memberVO">
     <![CDATA[
	     update kt_user
	     set userPassword=#{userPassword}, userName=#{userName}, userEmail=#{userEmail}
	     where
	     userId=#{userId}
      ]]>
	</update>

	<delete id="deleteMember" parameterType="String">
	<![CDATA[
	   delete from  kt_user
	   where
	   userId=#{userId}
	]]>
	</delete>

	<select id="loginById" resultType="memberVO"
		parameterType="String">
	<![CDATA[
		select * from kt_user
		where userId=#{userId} and approval_status='true' and userPassword=#{userPassword}
	]]>
	</select>
	
	<select id="partnerLoginById" resultType="partnerVO"
		parameterType="String">
	<![CDATA[
		select * from partner
		where partnerLicenseNum=#{userCompany};
	]]>
	</select>
	
	<update id="mod_myInformation" parameterType="memberVO">
     <![CDATA[
	     update kt_user
	     set userPassword=#{userPassword}, userName=#{userName}, userEmail=#{userEmail},
	     birth=#{birth}, userPhoneNumber=#{userPhoneNumber}, userPosition=#{userPosition},
	     userAddress1=#{userAddress1}, userAddress2=#{userAddress2}, userMajor=#{userMajor}
	     where
	     userId=#{userId}
      ]]>
	</update>
</mapper> 